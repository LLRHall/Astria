<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Margarine|Monoton|Orbitron" rel="stylesheet">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <script src="https://unpkg.com/gijgo@1.9.11/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.11/css/gijgo.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.9.3/introjs.css" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.9.3/intro.min.js" type="text/javascript"></script>
    <script src="replacer.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<style>
    body 
    {
        margin: auto;
        background-image: url(wallpaper1.png);
    }
    .center 
    {
        margin: 10px auto;
        padding: 20px;
        width: 50%;
    }
    .right
    {
        align-content: right;
        right: auto;
    }
    .tooltip
    {
        position: relative;
        display: inline-block;
        color: red;
        opacity: 1!important;
        z-index: 4;
    }
    .tooltip .tooltiptext 
    {
        visibility: hidden;
        width: 120px;
        background-color: black;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        position: absolute;
        z-index: 8;
    }
    .tooltip:hover .tooltiptext 
    {
        visibility: visible;
    }
    #navbar 
    {
            z-index:1200;
            overflow: hidden;
            background-color: #333;
    }
    
    #navbar a {
          float: right;
          display: block;
          color: #f2f2f2;
          text-align: center;
          padding: 10px 8px;
          text-decoration: none;
          font-size: 17px;
          border-radius: 8px;
    }
    
    #navbar a.active {
      background-color: #003366;
      color: white;
    }
    .content {
      padding: 16px;
    }
    .sticky {
      position: fixed;
      top: 0;
      width: 100%;
    }
    .sticky + .content {
      padding-top: 60px; 
    }
    .boxy {
    animation: slide-up 1s ease;
    }
    @keyframes slide-up {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>
<!---------------------------------------------------------------------------------------------------------------------->

<title>ASTRIA - Law Search Engine</title>
</head>

<body>
    <div id="navbar" class="shadow">
        <a class="active" href="javascript:void(0)" onclick="introJs().start();" style="margin: 0.8em 0.8em ;font-family: 'Orbitron'" align="middle">HELP</a>
        <a id="go-to-top" style="float:left;margin: 0.2em 0.2em; font-size: 24px ;font-family: 'Orbitron';cursor: pointer; "><img src="logo.png" width="42" height="42" align="middle"><b>&nbsp ASTRIA </b></a>
    </div>
    <br/>
    <br/>
    <br/>
        <div class="card w-75 center shadow p-3 mb-5 bg-white rounded">
            <div class="container">
                <form id = "send" action="" method="">

                        <div data-step="6" data-intro="Select query type" class="btn-group btn-group-toggle" data-toggle="buttons">
                                <label class="btn btn-secondary active">
                                  <input type="radio" name="options" value="1" autocomplete="off" checked> Keywords
                                </label>
                                <label class="btn btn-secondary">
                                  <input type="radio" name="options"  value="2" autocomplete="off"> Acts
                                </label>
                                <label class="btn btn-secondary">
                                  <input type="radio" name="options" value="3" autocomplete="off"> Cases
                                </label>
                                <label class="btn btn-secondary">
                                        <input type="radio" name="options" value="4" autocomplete="off"> <span class='tooltip' style="color:white!important"> Query <span class='tooltiptext'> Tell us about your situation </span></span>
                                </label>
                        </div>
                  
                    <div class="row">
                        <div  data-step="1" data-intro="Enter your queries here !" class="col-md-12">
                            <br/>
                                <div class="form-group">
                                    <input type="text" class="form-control" onkeyup="myListSend()" id="query" list="datalist" placeholder="Search here">
                                    <datalist id="datalist"> </datalist>
                                </div>
                        </div>
                    </div>
                 
                    <div class="row">
                        <div data-step="2" data-intro="Filter your results by date" class="col-md-3 ">
                            <div class="form-group">
                              
                                <input id="startDate" width="200" placeholder="Start Date"/>
                              
                                <script>
                                    var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
                                    $('#startDate').datepicker({
                                        uiLibrary: 'bootstrap4',
                                        iconsLibrary: 'fontawesome',
                                        maxDate: function () {
                                        return $('#endDate').val();
                                        }});
                                </script>
                            </div>
                            <div class="form-group">
                                <input id="endDate" width="200" placeholder="End Date"/>
                                <script>
                                    var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
                                    $('#endDate').datepicker({
                                        uiLibrary: 'bootstrap4',
                                        iconsLibrary: 'fontawesome',
                                        minDate: function () {
                                            return $('#startDate').val();
                                        }
                                    });
                                </script>
                            </div>
                        </div>
                        <div data-step="3" data-intro="Filter by Category" class="col-md-3">
                            <div class="form-group">
                              
                                <input type="text" class="form-control" id="cat_in" placeholder="Category"/>
                            </div>
                        </div>
                        <div data-step="4" data-intro="Filter by specific Acts" class="col-md-3">
                            <div class="form-group">                                  
                                <input type="text" class="form-control" id="act_in" placeholder="Acts"/>
                            </div>
                        </div>
                        <div data-step="5" data-intro="Filter by a specific Judge" class="col-md-3">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="jud_in" placeholder="Judge"/>
                                </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3"> </div>
                        <div class="col-md-3"> </div>
                        <div class="col-md-3"> </div>
                        <div class="col-md-3 text-center"> 
                            <button id="button" name="button" class="btn btn-primary" style="height:50px;width:200px;">Search</button> 
                        </div>
                    </div>
                </form>
            </div>
        </div>  
    </div>
    <br/>
<!-------------------------------------------------------------------------------------------------------------------->

    <!-- <div class="card w-75 center">
        <div class="card-body">
            <h5 class="card-title"><b>Case title</b></h5>
            <p class="card-text">
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th scope="col" >Judgment</th>
                            <th scope="col" > Judge <span class="badge badge-primary badge-pill">1</span>
                            </th>
                            <th scope="col">Acts cited <span class="badge badge-primary badge-pill">14</span></th>
                            <th scope="col">Categories <span class="badge badge-primary badge-pill">10</span></th>
                            <th scope="col">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="judgement">''</td>
                            <td id="judge">''</td>
                            <td id="acts">''</td>
                            <td id="cat">''</td>
                            <td id="date">''</td>
                        </tr>
                    </tbody>
                </table>
        <div>
    </div>
    </p>
    <span id="more" style="display:none;">
        <div class="card summary">
            <h5 class="card-header">Summary</h5>
            <div class="card-body">
                <h5 class="card-title">The Big Robbery</h5>
                <p class="card-text">
                    erisque enim ligula venenatis dolor. Maecenas nisl est, ultrices nec congue eget, auctor vitae massa. Fusce luctus vestibulum augue ut aliquet. Nunc sagittis dictum nisi, sed ullamcorper ipsum dignissim ac. In at libero sed nunc venenatis imperdiet sed ornare turpis. Donec vitae dui eget tellus gravida venenatis. Integer fringilla congue eros non fermentum. Sed dapibus pulvinar nibh tempor porta.
                </p>
            </div>
        </div>
    </span>
    <br>
            <a class="btn btn-primary" id="myBtn" onclick="mySum('0')">Read More</a>
        </div>
    </div> -->

      <!------------------------------------------------------------------------------------------------------------------------------>
    <div id="cards"></div>
    <script>
        function RecieveFunc(data){
            $("#cards").empty();
            if(data.length===0){
                $("#cards").append('<div class="card text-center shadow rounded w-75 center"><div class="card-body"><h5 class="card-title">No results found!</h5></div></div>')
            }
            else{
                for(i=0;i<data.length/2;i++){
                var jd = data[i];
                var act = [];
                for(count=0;count<data[i+data.length/2].length;count++){
                    act.push('<a target="blank" href="/acts/'+data[i+data.length/2][count]+'.txt">'+data[i+data.length/2][count]+'</a>');
                };
                var act_num = data[i+data.length/2].length;
                var cat = jd._source.subject.split('| ').join(', ').split('$$$').join(', ');
                var cat_num = cat.split(', ').length;
                var judge = jd._source.judge;
                var judgement = jd._source.result;
                var summary = jd._source.Summary200;
                var title = jd._source.title;
                var cit_id = jd._source.cit_id;
                var date = jd._source.date.substring(0,4)+'/'+jd._source.date.substring(4,6)+'/'+jd._source.date.substring(6,8);
                var filenameUrl = 'cases/'+ jd._source.filename + '.txt';
                $("#cards").append('<br><div class="card w-75 center boxy shadow p-3 mb-5 bg-white rounded"><div class="card-body"><h5 class="card-title tooltip" style="color:grey;font-size: 24px"><b>'+title+'</b><span class="tooltiptext" style="font-size: 12px">'+cit_id+'</span></h5><p class="card-text"><table class="table table-sm"><thead><tr><th scope="col" >Judgment</th><th scope="col"> Judge </th><th scope="col">Acts cited <span class="badge badge-primary badge-pill">'+act_num+'</span></th><th scope="col">Categories <span class="badge badge-primary badge-pill">'+cat_num+'</span></th><th scope="col">Date</th></tr></thead><tbody><tr><td id="judgement">'+judgement+'</td><td id="judge">'+judge+'</td><td id="acts">'+act+'</td><td id="cat">'+cat+'</td><td id="date">'+date+'</td></tr></tbody></table><div></div></p><span id="more'+i+'" style="display:none;"><div class="card summary"><h5 class="card-header">Summary</h5><div class="card-body"><h5 class="card-title">'+title+'</h5><p class="card-text">'+replacer(summary)+'</p></div></div></span><br><a class="btn btn-primary" id="myBtn'+i+'" onclick="mySum('+i+')" style="color: white">Read More</a><span>&nbsp;&nbsp;<span><a target="blank" href="'+filenameUrl+'" class="btn btn-primary">Download</a></div></div>');
                };
            }
        };
        function dateModifier(date){
            var temp = date.split('/');
            if(temp.length===3){
                return temp[2].concat(temp[1], temp[0]);
            }
            else{
                return '';
            }
            
        };
        
        $("#send").submit(function(e)
        {
            e.preventDefault();
            var radioValue = $("input[name='options']:checked").val();
            var q = $("#query").val();
            var s_d = dateModifier($("#startDate").val());
            var e_d = dateModifier($("#endDate").val());
            var c = $("#cat_in").val();
            var j = $("#jud_in").val();
            var a = $("#act_in").val();
            var payload = {"query":q.split(" "),"time":{"from":s_d,"to":e_d},"cat":c,"judge": j,"act": a};
           
            jQuery.ajax ({
                url: "query"+radioValue,
                type: "POST",
                data: JSON.stringify(
            
            [{
                "query":q.split(' '),
                "time":{"from":s_d,"to":e_d},
                "cat": c,
                "judge": j,
                "act": a
            }]
            ),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                beforeSend:function(){ $("#cards").append('<div class="text-center"><div class="spinner-border text-secondary" style="width: 3rem; height: 3rem;" role="status"><span class="sr-only">Loading...</span></div></div>') },
                success: function(data){
                    RecieveFunc(data);
                }
            });
        });

        function mySum(id) 
            {
                    var moreText = document.getElementById("more"+id);
                    var btnText = document.getElementById("myBtn"+id);
                    if (moreText.style.display === "none")
                    {
                        btnText.innerHTML = "Read Less";
                        moreText.style.display = "inline";
                    }
                    else 
                    {
                        btnText.innerHTML = "Read More";
                        moreText.style.display = "none";
                    }
            }
        $(document).ready(function(){
            if(!localStorage.getItem("key"))
            {
                introJs().start();
                localStorage.setItem("key", "keyValue");
            };
        });
        $(document).ready(function(){
            window.onscroll = function() {myFunction()};
        var navbar = document.getElementById("navbar");
        var sticky = navbar.offsetTop;
        function myFunction() 
        {
          if (window.pageYOffset >= sticky) 
          {
            navbar.classList.add("sticky")
          } else 
          {
            navbar.classList.remove("sticky");
          }
        }
        });
        function myListSend()
        {
            var input = $("#query").val();
            var radioValue = $("input[name='options']:checked").val();
            var arr = ["keywords","keywords","acts","titles"]
            jQuery.ajax ({
                url: "http://ec2-18-234-229-115.compute-1.amazonaws.com:8081/"+arr[Number(radioValue)],
                type: "POST",
                data: {"query":input},
                success: function(data){
                   // setTimeout(myListGet(data), 1000);
                    myListGet(data);
                }
            });
        };
        function myListGet(keys)
        {
            $("#datalist").empty();
            // $(keys).each(function(i, key){
            //     console.log(i + " " +key.data)
            try {

                $("#datalist").append('<option value="'+keys[0].data+'">'+keys[0].data+'</option><option value="'+keys[1].data+'">'+keys[1].data+'</option><option value="'+keys[2].data+'">'+keys[2].data+'</option><option value="'+keys[3].data+'">'+keys[3].data+'</option><option value="'+keys[4].data+'">'+keys[4].data+'</option>');

            } catch (error) {
                $('#datalist').empty()
            }
           
            // })
        };
        $('#go-to-top').each(function(){
            $(this).click(function(){ 
                $('html,body').animate({ scrollTop: 0 }, 'slow');
                $('form')[0].reset()
                    return false; 
                });
        });
    </script>
    <br>
</body>

</html>
